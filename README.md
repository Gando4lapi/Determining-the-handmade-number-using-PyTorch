# Determining-the-handmade-number-using-PyTorch

–ü—Ä–æ–µ–∫—Ç –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä—É–∫–æ–ø–∏—Å–Ω—ã—Ö —Ü–∏—Ñ—Ä (–æ—Ç 0 –¥–æ 9) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ PyTorch –∏ –¥–∞—Ç–∞—Å–µ—Ç–∞ MNIST.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û –ø—Ä–æ–µ–∫—Ç–µ](#–æ-–ø—Ä–æ–µ–∫—Ç–µ)
- [–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏](#—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–æ–¥–∞](#–æ–±—ä—è—Å–Ω–µ–Ω–∏–µ-–∫–æ–¥–∞)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–º–æ–¥–µ–ª–∏)
- [–†–µ–∑—É–ª—å—Ç–∞—Ç—ã](#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è](#–≤–æ–∑–º–æ–∂–Ω—ã–µ-—É–ª—É—á—à–µ–Ω–∏—è)
- [–ê–≤—Ç–æ—Ä](#–∞–≤—Ç–æ—Ä)

## üéØ –û –ø—Ä–æ–µ–∫—Ç–µ

–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî –Ω–∞—É—á–∏—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å —Ä—É–∫–æ–ø–∏—Å–Ω—ã–µ —Ü–∏—Ñ—Ä—ã —Å –ø–æ–º–æ—â—å—é –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏. –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞—Ç–∞—Å–µ—Ç MNIST ‚Äî –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –Ω–∞–±–æ—Ä –∏–∑ 70,000 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ü–∏—Ñ—Ä —Ä–∞–∑–º–µ—Ä–æ–º 28x28 –ø–∏–∫—Å–µ–ª–µ–π.

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç:**
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞—Ç–∞—Å–µ—Ç MNIST
- –û–±—É—á–∞–µ—Ç –ø—Ä–æ—Å—Ç—É—é –Ω–µ–π—Ä–æ–Ω–Ω—É—é —Å–µ—Ç—å
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –º–æ–¥–µ–ª—å –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
- –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–∏–º–µ—Ä—ã —Ü–∏—Ñ—Ä

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Python 3.x**
- **PyTorch** - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π
- **TorchVision** - –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **NumPy** - —Ä–∞–±–æ—Ç–∞ —Å –º–∞—Å—Å–∏–≤–∞–º–∏ –∏ —á–∏—Å–ª–∞–º–∏
- **Matplotlib** - —Å–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π
- **tqdm** - –∫—Ä–∞—Å–∏–≤—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
```bash
git clone https://github.com/Gando4lapi/Determining-the-handmade-number-using-PyTorch
cd Determining-the-handmade-number-using-PyTorch
```

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
```bash
pip install torch torchvision numpy matplotlib tqdm
```

## üìñ –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–æ–¥–∞

### 1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö MNIST

```python
from torchvision import datasets, transforms

# –ó–∞–≥—Ä—É–∂–∞–µ–º –æ–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
mnist_train = datasets.MNIST(root='./datasets', train=True, 
                           transform=transforms.ToTensor(), download=True)

# –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ  
mnist_test = datasets.MNIST(root='./datasets', train=False,
                          transform=transforms.ToTensor(), download=True)
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –°–∫–∞—á–∏–≤–∞–µ–º –¥–∞—Ç–∞—Å–µ—Ç MNIST —Å 60,000 –æ–±—É—á–∞—é—â–∏—Ö –∏ 10,000 —Ç–µ—Å—Ç–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- `ToTensor()` –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤ —á–∏—Å–ª–æ–≤—ã–µ –º–∞—Å—Å–∏–≤—ã –¥–ª—è PyTorch

### 2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö

```python
from torch.utils.data import DataLoader

train_loader = DataLoader(mnist_train, batch_size=100, shuffle=True)
test_loader = DataLoader(mnist_test, batch_size=100, shuffle=False)
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –†–∞–∑–±–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ –ø–∞—á–∫–∏ –ø–æ 100 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –æ–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ª—É—á—à–µ–≥–æ –æ–±—É—á–µ–Ω–∏—è
- –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏

```python
import torch.nn as nn

class LogisticRegressionModel(nn.Module):
    def __init__(self):
        super().__init__()
        # –°–ª–æ–π –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç 784 –ø–∏–∫—Å–µ–ª—è –≤ 10 —Ü–∏—Ñ—Ä
        self.linear = nn.Linear(28*28, 10)

    def forward(self, x):
        # –ü—Ä–µ–≤—Ä–∞—â–∞–µ–º –∫–∞—Ä—Ç–∏–Ω–∫—É 28x28 –≤ –≤–µ–∫—Ç–æ—Ä –∏–∑ 784 —á–∏—Å–µ–ª
        x = x.view(-1, 28*28)
        # –ü—Ä–∏–º–µ–Ω—è–µ–º –ª–∏–Ω–µ–π–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ
        return self.linear(x)
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –°–æ–∑–¥–∞—ë–º –ø—Ä–æ—Å—Ç—É—é –º–æ–¥–µ–ª—å - –æ–¥–∏–Ω —Å–ª–æ–π
- –í—Ö–æ–¥: 784 –ø–∏–∫—Å–µ–ª—è (28x28 –∫–∞—Ä—Ç–∏–Ω–∫–∞)
- –í—ã—Ö–æ–¥: 10 —á–∏—Å–µ–ª (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è —Ü–∏—Ñ—Ä 0-9)

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—É—á–µ–Ω–∏—è

```python
import torch.optim as optim
import torch.nn.functional as F

model = LogisticRegressionModel()
optimizer = optim.SGD(model.parameters(), lr=0.1)
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –°–æ–∑–¥–∞—ë–º —ç–∫–∑–µ–º–ø–ª—è—Ä –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏
- –í—ã–±–∏—Ä–∞–µ–º –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä SGD —Å —à–∞–≥–æ–º –æ–±—É—á–µ–Ω–∏—è 0.1
- –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä –±—É–¥–µ—Ç —É–ª—É—á—à–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏

### 5. –ü—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è

```python
from tqdm import tqdm

model.train()  # –ü–µ—Ä–µ–≤–æ–¥–∏–º –º–æ–¥–µ–ª—å –≤ —Ä–µ–∂–∏–º –æ–±—É—á–µ–Ω–∏—è
for images, labels in tqdm(train_loader):
    optimizer.zero_grad()                    # –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã
    outputs = model(images)                  # –ü–æ–ª—É—á–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
    loss = F.cross_entropy(outputs, labels)  # –°—á–∏—Ç–∞–µ–º –æ—à–∏–±–∫—É
    loss.backward()                          # –í—ã—á–∏—Å–ª—è–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã
    optimizer.step()                         # –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –ë–µ—Ä—ë–º –ø–∞—á–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
2. –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ –º–æ–¥–µ–ª—å
3. –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏
4. –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏, —á—Ç–æ–±—ã —É–º–µ–Ω—å—à–∏—Ç—å –æ—à–∏–±–∫—É

### 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞

```python
model.eval()  # –ü–µ—Ä–µ–≤–æ–¥–∏–º –≤ —Ä–µ–∂–∏–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
correct = 0
total = 0

with torch.no_grad():  # –û—Ç–∫–ª—é—á–∞–µ–º –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤
    for images, labels in test_loader:
        outputs = model(images)
        _, predicted = torch.max(outputs, 1)  # –í—ã–±–∏—Ä–∞–µ–º —Å–∞–º—ã–π –≤–µ—Ä–æ—è—Ç–Ω—ã–π –∫–ª–∞—Å—Å
        correct += (predicted == labels).sum().item()
        total += labels.size(0)

print(f'Test accuracy: {correct / total:.4f}')
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–æ–¥–µ–ª—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –°—á–∏—Ç–∞–µ–º —Å–∫–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä —É–≥–∞–¥–∞–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –í—ã—á–∏—Å–ª—è–µ–º —Ç–æ—á–Ω–æ—Å—Ç—å –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏

**–ü—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏:**
- –ù–∞—à–∞ –º–æ–¥–µ–ª—å - —ç—Ç–æ –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–∞—è –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å
- –û–Ω–∞ –±–µ—Ä—ë—Ç –∫–∞—Ä—Ç–∏–Ω–∫—É 28x28 –ø–∏–∫—Å–µ–ª–µ–π (784 —á–∏—Å–ª–∞)
- –ü—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –∏—Ö –≤ 10 —á–∏—Å–µ–ª (–æ—Ü–µ–Ω–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π —Ü–∏—Ñ—Ä—ã 0-9)
- –°–∞–º–æ–µ –±–æ–ª—å—à–æ–µ —á–∏—Å–ª–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–∞—è —Ü–∏—Ñ—Ä–∞ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:**
- –¢–∏–ø: –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è (–ª–∏–Ω–µ–π–Ω—ã–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä)
- –í—Ö–æ–¥–Ω–æ–π —Ä–∞–∑–º–µ—Ä: 784 (28√ó28 –ø–∏–∫—Å–µ–ª–µ–π)
- –í—ã—Ö–æ–¥–Ω–æ–π —Ä–∞–∑–º–µ—Ä: 10 (–∫–ª–∞—Å—Å—ã 0-9)
- –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å: CrossEntropyLoss
- –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä: SGD —Å learning rate = 0.1

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

- **–¢–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö: ~91%**

## üë§ –ê–≤—Ç–æ—Ä

**–ö–∞–ø–Ω–∏–∫ –î–∞–Ω–∏–ª**

- GitHub: [@Gando4lapi](https://github.com/Gando4lapi)
- Email: kapnik.dan@gmail.com

---

**‚≠ê –ü–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥–æ—á–∫—É, –µ—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –±—ã–ª –ø–æ–ª–µ–∑–µ–Ω!**
